<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Profile Dropdown</title>
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <style>
        body {
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .test-section {
            margin: 30px 0;
            padding: 20px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
        }

        .test-button {
            margin: 10px 5px;
            padding: 10px 20px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }

        .test-button:hover {
            background: #5568d3;
        }

        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 8px;
            font-family: monospace;
        }

        .status.success {
            background: #d4edda;
            color: #155724;
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
        }

        .status.info {
            background: #d1ecf1;
            color: #0c5460;
        }
    </style>
</head>

<body>
    <!-- Include Navbar Component -->
    <div id="navbarContainer"></div>

    <div class="test-container">
        <h1 style="text-align: center; color: #667eea; margin-bottom: 10px;">
            üß™ Profile Dropdown Test Page
        </h1>
        <p style="text-align: center; color: #666; margin-bottom: 30px;">
            Use this page to test the user profile dropdown functionality
        </p>

        <!-- Test Section 1: Login Status -->
        <div class="test-section">
            <h2>1Ô∏è‚É£ Login Status</h2>
            <p>Check if user is logged in and profile section is visible</p>
            <button class="test-button" onclick="checkLoginStatus()">Check Status</button>
            <div id="loginStatus"></div>
        </div>

        <!-- Test Section 2: Simulate Login -->
        <div class="test-section">
            <h2>2Ô∏è‚É£ Simulate Login</h2>
            <p>Add test credentials to localStorage to simulate a logged-in user</p>
            <button class="test-button" onclick="simulateLogin()">Simulate Login</button>
            <button class="test-button" style="background: #dc3545;" onclick="simulateLogout()">Simulate Logout</button>
            <div id="authStatus"></div>
        </div>

        <!-- Test Section 3: Dropdown Toggle -->
        <div class="test-section">
            <h2>3Ô∏è‚É£ Dropdown Toggle</h2>
            <p>Manually toggle the dropdown to test visibility</p>
            <button class="test-button" onclick="openDropdown()">Open Dropdown</button>
            <button class="test-button" onclick="closeDropdown()">Close Dropdown</button>
            <div id="dropdownStatus"></div>
        </div>

        <!-- Test Section 4: Check Elements -->
        <div class="test-section">
            <h2>4Ô∏è‚É£ Element Check</h2>
            <p>Verify all required elements exist in the DOM</p>
            <button class="test-button" onclick="checkElements()">Check Elements</button>
            <div id="elementStatus"></div>
        </div>

        <!-- Instructions -->
        <div class="test-section" style="background: #f8f9fa;">
            <h2>üìã Testing Instructions</h2>
            <ol style="line-height: 1.8;">
                <li><strong>Check Login Status</strong> - See if you're currently logged in</li>
                <li><strong>Simulate Login</strong> - Add test user data to localStorage</li>
                <li><strong>Refresh Page</strong> - The navbar should update automatically</li>
                <li><strong>Click Profile Button</strong> - Test the dropdown in the navbar</li>
                <li><strong>Check Animations</strong> - Dropdown should scale and fade smoothly</li>
                <li><strong>Click Outside</strong> - Dropdown should close automatically</li>
            </ol>
        </div>
    </div>

    <script src="assets/js/components-loader.js"></script>
    <script src="assets/js/auth.js"></script>

    <script>
        function checkLoginStatus() {
            const status = document.getElementById('loginStatus');
            const accessToken = localStorage.getItem('accessToken');
            const userEmail = localStorage.getItem('userEmail');
            const profileSection = document.getElementById('userProfileSection');
            const loginButton = document.getElementById('loginLink');

            let html = '';

            if (accessToken) {
                html += '<div class="status success">‚úÖ User is LOGGED IN</div>';
                html += `<div class="status info">Email: ${userEmail || 'Not set'}</div>`;
            } else {
                html += '<div class="status error">‚ùå User is NOT logged in</div>';
            }

            if (profileSection) {
                const isHidden = profileSection.classList.contains('hidden');
                html += `<div class="status ${isHidden ? 'error' : 'success'}">
                    Profile Section: ${isHidden ? '‚ùå Hidden' : '‚úÖ Visible'}
                </div>`;
            } else {
                html += '<div class="status error">‚ùå Profile section element not found!</div>';
            }

            if (loginButton) {
                const isHidden = loginButton.classList.contains('hidden');
                html += `<div class="status ${isHidden ? 'success' : 'info'}">
                    Login Button: ${isHidden ? '‚úÖ Hidden' : '‚ö†Ô∏è Visible'}
                </div>`;
            }

            status.innerHTML = html;
        }

        function simulateLogin() {
            localStorage.setItem('accessToken', 'test-token-12345');
            localStorage.setItem('userEmail', 'test.user@example.com');
            localStorage.setItem('userId', 'test-user-id');
            localStorage.setItem('firstName', 'Test');
            localStorage.setItem('userRole', 'user');

            updateNavbarAuth();

            document.getElementById('authStatus').innerHTML = `
                <div class="status success">‚úÖ Simulated login successful!</div>
                <div class="status info">Please refresh the page to see the navbar update</div>
                <button class="test-button" onclick="location.reload()">Refresh Page Now</button>
            `;
        }

        function simulateLogout() {
            localStorage.removeItem('accessToken');
            localStorage.removeItem('userEmail');
            localStorage.removeItem('userId');
            localStorage.removeItem('firstName');
            localStorage.removeItem('userRole');

            updateNavbarAuth();

            document.getElementById('authStatus').innerHTML = `
                <div class="status success">‚úÖ Logged out successfully!</div>
                <div class="status info">Refresh to see changes</div>
                <button class="test-button" onclick="location.reload()">Refresh Page Now</button>
            `;
        }

        function openDropdown() {
            const dropdown = document.getElementById('profileDropdown');
            const status = document.getElementById('dropdownStatus');

            if (!dropdown) {
                status.innerHTML = '<div class="status error">‚ùå Dropdown element not found</div>';
                return;
            }

            dropdown.classList.remove('hidden', 'scale-95', 'opacity-0');
            dropdown.classList.add('scale-100', 'opacity-100');

            status.innerHTML = '<div class="status success">‚úÖ Dropdown opened manually</div>';
        }

        function closeDropdown() {
            const dropdown = document.getElementById('profileDropdown');
            const status = document.getElementById('dropdownStatus');

            if (!dropdown) {
                status.innerHTML = '<div class="status error">‚ùå Dropdown element not found</div>';
                return;
            }

            dropdown.classList.remove('scale-100', 'opacity-100');
            dropdown.classList.add('scale-95', 'opacity-0', 'hidden');

            status.innerHTML = '<div class="status success">‚úÖ Dropdown closed manually</div>';
        }

        function checkElements() {
            const elements = {
                'userProfileSection': document.getElementById('userProfileSection'),
                'profileBtn': document.getElementById('profileBtn'),
                'profileDropdown': document.getElementById('profileDropdown'),
                'userEmail': document.getElementById('userEmail'),
                'dropdownEmail': document.getElementById('dropdownEmail'),
                'loginLink': document.getElementById('loginLink'),
                'logoutBtn': document.getElementById('logoutBtn')
            };

            let html = '<h3 style="margin: 15px 0;">Element Status:</h3>';

            for (const [name, element] of Object.entries(elements)) {
                if (element) {
                    html += `<div class="status success">‚úÖ ${name}: Found</div>`;
                } else {
                    html += `<div class="status error">‚ùå ${name}: Not Found</div>`;
                }
            }

            document.getElementById('elementStatus').innerHTML = html;
        }
    </script>
</body>

</html>